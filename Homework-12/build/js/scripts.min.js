"use strict";var urlRegEx=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/,form=document.querySelector(".notes-form"),input=document.querySelector(".input-text"),btnSubmit=document.querySelector(".btn-submit"),noteList=document.querySelector(".notes-list"),source=document.querySelector("#js-template").innerHTML.trim(),template=Handlebars.compile(source);function addNote(){event.preventDefault();var r=input.value,n=JSON.parse(localStorage.getItem("link"))||[];n.every(function(e){return e.url!==r})?urlRegEx.test(r)?(fetch("http://api.linkpreview.net/?key=5c532304d318b4f07843367da32d6a39a636c4b68bb74&q=".concat(r)).then(function(e){if(e.ok)return e.json();throw new Error("error",e.statusText)}).then(function(e){var t={title:e.title,descr:e.description,image:e.image,url:r};n.unshift(t),localStorage.setItem("link",JSON.stringify(n)),createListItem(t)}).catch(function(e){e&&alert("Site doesn't exist")}),form.reset()):alert("Your link is invalid. Please, check"):alert("This link already exists")}function removeListItem(){if(event.target.classList.contains("btn-close")){event.target.parentNode.remove();var e=JSON.parse(localStorage.getItem("link"));e=e.filter(function(e){return console.log(e)}),localStorage.setItem("link",JSON.stringify(e))}}function createListItem(){var e=JSON.parse(localStorage.getItem("link")).reduce(function(e,t){return e+template(t)},"");noteList.innerHTML=e}function renderNotesList(){(JSON.parse(localStorage.getItem("link"))||[]).forEach(function(e){return createListItem(e)})}form.addEventListener("submit",addNote),noteList.addEventListener("click",removeListItem),window.addEventListener("DOMContentLoaded",renderNotesList);